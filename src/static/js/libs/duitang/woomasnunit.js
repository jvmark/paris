if(!String.prototype.lenB){String.prototype.lenB=function(){return this.replace(/[^\x00-\xff]/g,"**").length}}if(!String.prototype.leftB){String.prototype.leftB=function(g){var f=this,d=f.slice(0,g),e=d.replace(/[^\x00-\xff]/g,"**").length;if(e<=g){return d}e-=d.length;switch(e){case 0:return d;case g:return f.slice(0,g>>1);default:var b=g-e,a=f.slice(b,g),c=a.replace(/[\x00-\xff]/g,"").length;return c?f.slice(0,b)+a.leftB(c):f.slice(0,b)}}}if(!String.prototype.cut){String.prototype.cut=function(f,d,c){var e=this;r=c?e.substr(0,f):e.leftB(f);return r==e?r:r+(typeof d==="undefined"?"…":d)}}(function(){if(!$.Woo){return}var b=navigator.userAgent.toString().toLowerCase(),h=!!b.match(/ipad/ig),i=!h,f=[],c=[],d=[],e=[];d=['<% for (var i = 0; i < list.length; i ++) { %><% var u = list[i],indx = $unit(u.id,u),olnk = $outlnk(u); %><% if(!indx) continue; %><div class="woo"><div class="j"> <div class="mbpho" style="height:<%=u.iht > 800 ? 800 : u.iht%>px;"><a target="_blank" class="a" href="http://www.duitang.com/people/mblog/<%=u.id%>/detail/"><img <%=srcd ? "srcd" : "src"%>="<%=u.isrc%>" height="<%=u.iht%>" /><%= u.iht > 800 ? "<u style=\'margin-top:-"+(u.iht-720)+"px\'></u>" : ""%></a> </div> <div class="d"><span class="d1 d1-done"><%=u.favc%></span><span class="d2 d2-done"><%=u.zanc%></span><span class="d3"><%=u.repc%></span></div> <div class="g"><%=u.msg%><% if(olnk){ %>&nbsp;<%=$price(u,olnk)%><% } %></div> <ul> <li class="f"><a target="_blank" href="http://www.duitang.com/topics/"><img width="24" height="24" src="<%=u.ava%>"></a><p><a class="p" target="_blank" href="http://www.duitang.com/topics/"><%=$cut(u.unm,16)%></a>&nbsp;收集到&nbsp;<% if(u.albid){ %><a target="_blank" href="http://www.duitang.com/topics/"><%=$cut(u.albnm,12)%></a>&nbsp;专辑中<% }else{ %><a target="_blank" href="http://www.duitang.com/topics/">默认专辑</a><% } %></p></li> <% for(var j=0,l=hasrp?u.cmts.length:0; j<l; j++){ %> <li><a target="_blank" href="http://www.duitang.com/topics/"><img width="24" height="24" src="<%=u.cmts[j].ava%>"></a><p><a target="_blank" href="http://www.duitang.com/topics/"><%=$cut(u.cmts[j].name,16)%></a>&nbsp;<%=u.cmts[j].cont%></p></li> <% } %></ul></div></div><% } %>',null,null],c=[function(j){if(j&&j.length&&$.isPlainObject(j[0])){var n=e[0],m={list:j,srcd:i,hasrp:n.hasrp},l=template.compile(d[0]),k=$.trim(l(m));return k}else{return j}},null,null],f=[function(l){var o=g(l);if(o){return o}var k=[[],true];try{var j=$.isPlainObject(l)?l:$.parseJSON(l)}catch(n){return k}if(j.success){var m=j.data,p;e[0]={hasrp:!!m.hasrp};k=[m.blogs,m.has_next,m.totalcount]}return k},function(p){typeof DEBUG!=="undefined"&&DEBUG&&(p={data:{totalcount:8907,has_next:true,albums:[]},success:true},p.data.albums[23]=0);var u=g(p);if(u){return u}var s=[[],true];try{var m=$.isPlainObject(p)?p:$.parseJSON(p)}catch(q){return s}if(m.success){var k=$(null),v=m.data;for(var o=0,t=v.albums,n=t.length;o<n;o++){var j=['<div class="woo"  data-ht="328"> <div class="albbigimg"> <p class="lev2"></p> <p class="lev1"></p> <a class="lev0" href="http://www.duitang.com/topics/" target="_blank" ><img src="http://cdn.duitang.com/uploads/item/201208/07/20120807235954_URvcE.thumb.200_200_c.jpeg" alt="动漫集 ."></a> <p class="lev3"></p> <div>动漫集 .</div> </div> <ul> <li><span>3736个收集 | 103人喜欢</span></li> <li class="clr"><a href="http://www.duitang.com/topics/" target="_blank" ><img src="http://cdn.duitang.com/uploads/people/201309/15/20130915021315_kyMMu.thumb.24_24_c.jpeg" />笑我作茧自缚还…</a></li> <li>有壁纸.</li> </ul> </div>'].join("");k=k.add($(j))}s=[k.toArray(),v.has_next]}return s},function(o){var v=g(o);if(v){return v}var q=[[],true];try{var k=$.isPlainObject(o)?o:$.parseJSON(o)}catch(p){return q}if(k.success){var j=$(null),w=k.data,y=96;for(var n=0,t=w.blogs,m=t.length;n<m;n++){var s=Math.round(t[n].iht*y/200),x=t[n].iht>800?'<div class="mask"></div>':"",u=x?384:s;unt=['<div class="woo" data-ht="'+u+'"><div class="j" style="height:'+u+'px;"><a href="http://m.duitang.com/people/mblog/'+t[n].id+'/detail/"><img srcd="'+t[n].isrc+'" width="96" /></a>'+x+"</div></div>"].join("");j=j.add($(unt))}q=[j.toArray(),w.has_next]}return q}];function g(m){var k=$.trim(m),n=k.substr(0,1);if(n!="{"&&n!="["){if(k.substr(0,9)==="<!doctype"){return[[],true]}if(i){k=k.replace(/(<img[^>]* class=[\'\"]?i[\'\"]?[^>\"\']*)src/ig,function(p,o){return o+"srcd"})}var j=$(k).filter(".woo"),l=j.attr("hasnext")==="False"?false:true;return[j.toArray(),l]}else{return null}}template.helper("$price",function(j,k){return j.buylnk?'<a class="dymprice bl dib '+(!j.price?"by":"")+'" href="'+k+'" target="_blank"><u class="_tb" title="去购买">'+(j.price?"￥"+j.price:"&nbsp;")+"</u></a>":""});template.helper("$outlnk",function(j){var k=j.buylnk||"";return k});template.helper("$cut",function(k,j){return k.cut(j,"…")});template.helper("$unit",function(l,j){l+="";var k=a.masnUnits;if(!k[l]||1){k[l]=j,a.ulen++,k[l].indx=a.ulen-1;return a.ulen}else{return 0}});var a=(function(){var j={ulen:0,init:function(l,k){j.analyzeResponse=l,j.render=k,j.masnUnits={}},reset:function(){j.ulen=0,j.masnUnits={}}};return j})();a.init(f,c);$.Woo.WooTemp=a})();